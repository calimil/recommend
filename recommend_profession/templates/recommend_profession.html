<!--#林洋洋：优化推荐专业页面，改进样式和用户体验-->
{% extends "base.html" %}
{% block title %}推荐专业{% endblock %}
{% block content %}
<script type="text/javascript">
    function reload() {
        setTimeout(function () {
            location.reload(true);
        }, 500);
    }
</script>
<script>
    function getProfessionDetail(x) {
        var y = {{ pro_js|safe }};
        var message = '<h4>' + x + '</h4><br>' +
            '<table class="table table-bordered table-hover table-striped" width="600px">';
        var count = 0;
        const col = 3;
        for (var i = 0; i < y.length; i++) {
            if (y[i]['fields']['type1'] === x) {
                if (count % col === 0) {
                    message = message + '<tr height="30px">';
                    message = message + '<td><a onclick="reload()" target="_blank" href="../profession/' + y[i]['fields']['profession_name'] + '专业">'
                        + y[i]['fields']['profession_name'] + '</a></td>';
                }
                else {
                    message = message + '<td><a onclick="reload()" target="_blank" href="../profession/' + y[i]['fields']['profession_name'] + '专业">'
                        + y[i]['fields']['profession_name'] + '</a></td>';
                }
                if (count % col === col - 1) {
                    message = message + '</tr>';
                }
                count++;
            }
        }
        let div = document.getElementById('profession_message');
        div.innerHTML = message;
    }
</script>
<div class="container-fluid" style="margin-top: 30px;">
    <div class="row">
        <div class="col-sm-2">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>专业类别</h4>
                </div>
                <div class="panel-body">
                    <ul class="nav nav-pills nav-stacked">
                        {% for foo in type1 %}
                        <li>
                            <button id="{{ foo }}" class="btn btn-info btn-block" style="margin-bottom: 5px;"
                                onclick="getProfessionDetail('{{ foo }}')">{{ foo }}</button>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-sm-7">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>专业列表</h4>
                </div>
                <div class="panel-body">
                    <div id="profession_message">
                        <script>
                            getProfessionDetail('工学')
                        </script>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-3">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>专业推荐</h4>
                </div>
                <div class="panel-body">
                    {% if have_done %}
                    <div class="alert alert-warning">
                        请完成<a href="../analysis/">性格测试</a>，专业推荐效果更佳
                    </div>
                    {% endif %}
                    <ul class="list-group">
                        {% for foo in profession_hot %}
                        <li class="list-group-item">
                            <a target="_blank" href="../profession/{{ foo.profession_name }}专业">{{ foo.profession_name}}</a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}